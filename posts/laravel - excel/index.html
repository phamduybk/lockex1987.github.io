<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <title>Laravel Excel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../../images/favicon.png">
    <link rel="stylesheet" href="../../css/style.css">
    <meta name="description" content="Laravel Excel">
  </head>
  <body>
    <article>
      <h2>Laravel Excel</h2>
      <p>Laravel Excel có nhiều phiên bản, các phiên bản không tương thích lẫn
        nhau. Chúng ta sẽ tìm hiểu phiên bản hiện tại: 3.1.</p>
      <p>Laravel Excel thực chất chỉ là wrapper của thư viện PhpSpreadsheet.</p>
      <h3>Cài đặt</h3>
      <p> Cài đặt với composer:</p>
      <pre>composer create-project --prefer-dist laravel/laravel laravel-excel
cd laravel-excel
composer require maatwebsite/excel</pre>
      <h3>Export </h3>
      <p>Tạo một đối tượng Export mới:</p>
      <pre>php artisan make:export UsersExport --model=User</pre>
      <p>Câu lệnh sẽ tạo file <code>UsersExport.php</code> ở thư mục <code>app/Exports</code>.</p>
      <p>UsersExport.php</p>
      <pre>&lt;?php
namespace App\Exports;

use App\User;
use Maatwebsite\Excel\Concerns\FromCollection;

class UsersExport implements FromCollection
{
    /**
    * @return \Illuminate\Support\Collection
    */
    public function collection()
    {
        return User::all();
    }
}</pre>
      <p>Tạo Controller:</p>
      <pre>php artisan make:controller UsersController</pre>
      <p>UsersController.php</p>
      <pre>&lt;?php
namespace App\Http\Controllers;

use App\Exports\UsersExport;
use Maatwebsite\Excel\Facades\Excel;

class UsersController extends Controller
{
    public function export() 
    {
        return Excel::download(new UsersExport(), 'users.xlsx');
    }
}</pre>
      <p>Khai báo route ở <code>web.php</code>:</p>
      <pre>Route::get('/users/export', 'UsersController@export');</pre>
      <p>Chỉnh cấu hình DB ở file <code>.env</code>.</p>
      <p>Chạy ứng dụng:</p>
      <pre>php artisan serve</pre>
      <p>Kiểm tra:</p>
      <p><a target="_blank" href="http://localhost:8000/users/export">localhost:8000/users/export</a>
      </p>
      <p>File mẫu:</p>
      <p><a target="_blank" href="UsersExport.php">UsersExport.php</a></p>
      <p><a target="_blank" href="users.blade.php">users.blade.php</a></p>
      <h3>Import</h3>
      <p>Ví dụ mẫu</p>
      <p>Validation</p>
      <p>Tách một post riêng</p>
      <h3>Tham khảo </h3>
      <p><a target="_blank" href="https://laravel-excel.com/">laravel-excel.com</a></p>
    </article>
    <script src="../../js/docs.js"></script>
  </body>
</html>
