<!doctype html>
<html>
 <head> 
  <meta content="text/html; charset=UTF-8" http-equiv="content-type"> 
  <title>Laravel Configuration</title> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="../../images/favicon.png">
  <link rel="stylesheet" href="../../css/style.css">
 </head> 
 <body>
  <article>
   <h1>Cấu hình</h1> 
   <p>Tất cả các files cấu hình của Laravel framework nó sẽ được đặt trong thư mục <code>config</code>. Với mỗi file trong thư mục đó, bạn có thể chỉnh sửa cấu hình theo ý bạn muốn.</p> 
   <h2>Truy cập các giá trị cấu hình</h2> 
   <p>Bạn có thể sễ dàng lấy được giá trị cấu hình ở bất cứ đâu trong ứng dụng của bạn bằng cách sử dụng hàm toàn cục <code>config</code>. Để lấy giá trị cấu hình bạn sử dụng "dấu chấm", bắt đầu bằng tên của file và giá trị bạn muốn lấy. Giá trị mặc định có thể được trả vè nếu thông số về biến cấu hình đó không tồn tại:</p> 
   <pre><code>$value = config('app.timezone');</code></pre> 
   <p>Để thiết lập giá trị cấu hình lúc thực thi, bạn truyền vào một mảng <code>config</code> như sau:</p> 
   <pre><code>config(['app.timezone' =&gt; 'America/Chicago']);</code></pre> 
   <h2>Cấu hình môi trường</h2> 
   <p>Thông thường, nó khá là hữu ích khi ứng dụng của bạn có giá trị cấu hình khác nhau trên các môi trường khác nhau. Giả sử, bạn cấu hình giá trị cache trên local của bạn và trên production của bạn khác nhau.</p> 
   <p>Để làm việc đó, Laravel tận dụng thư viện PHP <a href="https://github.com/vlucas/phpdotenv">DotEnv</a> được phát triển bởi Vance Lucas. Khi một ứng dụng mới được cài đặt, tại thư mục gốc sẽ có file <code>.env.example</code> file. Nếu bạn cài bằng Laravel Composer, file đấy sẽ tự động đổi tên thành <code>.env</code>. Nếu không thì bạn cần đổi tên file.</p> 
   <h4>Lấy lại cấu hình môi trường</h4> 
   <p>Tất cả các biến cấu hình sẽ được nạp bởi hàm PHP toàn cục <code>$_ENV</code> khi ứng dụng của bạn nhận request. Tuy nhiên, bạn có thể sử dụng hàm <code>env</code> để nhận giá trị cấu hình của bạn. Thực tế, nếu bạn xem lại các file cấu hình, bạn sẽ thấy một vài biến đã được sử dụng nó rồi:</p> 
   <pre><code>'debug' =&gt; env('APP_DEBUG', false),</code></pre> 
   <p>Giá trị thứ 2 truyền vào hàm <code>env</code> là "giá trị mặc định". Giá trị truyền vào sẽ được sử dụng nếu không có biến môi trường nào ứng với key đó.</p> 
   <p>File <code>.env</code> không nên đẩy lên source code ứng dụng của bạn, mỗi một developer / server sử dụng ứng dụng của bạn có thể có các cấu hình khác nhau.</p> 
   <p>Nếu ứng dụng của bạn phát triển bởi 1 nhóm, bạn có thể tiếp tục lưu lại file <code>.env.example</code> trong ứng dụng. Bằng cách đặt các giá trị vào file này, các thành viên khác của nhóm có thể nhìn thấy được các biến môi trường cần thiết để chạy ứng dụng của bạn.</p> 
   <h3>Xác định môi trường hiện tại</h3> 
   <p>Môi trường hiện tại được xác định thông qua biến<code>APP_ENV</code> trong file <code>.env</code>. Bạn có thể lấy biến này thông qua hàm <code>environment</code> trong <code>App</code> facade:</p> 
   <pre><code>$environment = App::environment();</code></pre> 
   <p>Ngoài ra bạn có thể truyền tham số vào hàm <code>environment</code> để kiểm tra xem môi trường có giống hay không. Hàm này sẽ trả về <code>true</code> nếu tham số truyền vào giống với biến môi trường:</p> 
   <pre><code>if (App::environment('local')) {
    // Môi trường local
}

if (App::environment('local', 'staging')) {
    // Môi trường là  local hoặc staging...
}</code></pre> 
   <h2>Cấu hình Caching</h2> 
   <p>Để tăng hiệu năng cho ứng dụng của bạn, bạn nên cache tất cả các file cấu hình bằng cách sử dụng lệnh <code>config:cache</code> Artisan command. Lệnh này sẽ gộp tất cả các file cấu hình trong ứng dụng của bạn thành một file duy nhất để tăng tốc độ tải của framework.</p> 
   <p>Bạn nên chạy lệnh <code>php artisan config:cache</code> trên con production của ứng dụng của bạn. Bạn không nên chạy nó ở môi trường phát triển nó vì các thông số cấu hình liên tục thay đổi khi phát triển ứng dụng.</p> 
   <h2>Chế độ bảo trì</h2> 
   <p>Khi ứng dụng của bạn ở chế độ bảo trì, một dao diện sẽ được hiển thị cho tất cả request vào ứng dụng của bạn. Thật dễ để "vô hiệu hóa" ứng dụng của bạn trong khi đang cập nhật hoặc bảo trì. Việc bảo trì nằm trong stack middleware cho ứng dụng của bạn. Nếu ứng dụng của bạn ở chế độ bảo trì, <code>MaintenanceModeException</code> sẽ bắn ra một status code là 503.</p> 
   <p>Để bật chế độ bảo trì, bạn chỉ cần thực thi lệnh <code>down</code>:</p> 
   <pre><code>php artisan down</code></pre> 
   <p>Ngoài ra bạn có thể cung cấp các lựa trọn <code>message</code> và <code>retry</code> khi thực hiện lệnh <code>down</code>. Nội dung <code>message</code> được dùng để hiển thị hoặc tạo một thông báo, trong khi giá trị <code>retry</code> sẽ được thiết lập như là giá trị <code>Retry-After</code> HTTP header's.</p> 
   <pre><code>php artisan down --message='Upgrading Database' --retry=60</code></pre> 
   <p>Để vô hiệu hóa chế độ bảo trì, sử dụng lệnh <code>up</code>:</p> 
   <pre><code>php artisan up</code></pre> 
   <h4>Template chế độ bảo trì</h4> 
   <p>Mặc định template chế độ bảo trì nằm tại <code>resources/views/errors/503.blade.php</code>. Bạn có thể thay đổi dao diện sao cho phù hợp với ứng dụng của bạn.</p> 
   <h4>Chế độ bảo trì &amp; Queues</h4> 
   <p>Khi ứng dụng của bạn đang ở chế độ bảo trì, không có <a href="https://giaphiep.com/docs/5.3/queues">queued jobs</a> nào được xử lý. Các jobs sẽ tiếp tục xử lý khi ứng dụng của bạn vô hiệu hóa chế độ bảo trì.</p> 
   <h4>Giải pháp khác cho chế độ bảo trì</h4> 
   <p>Vì chế độ bảo trì yêu cầu ứng dụng của bạn bị down trong vài giây, bạn có thể cân nhắc việc sử dụng cách khác như <a href="https://envoyer.io/">Envoyer</a> không có thời gian down khi triển khai với Laravel.</p> 
   <p> Nguồn: <a href="https://laravel.com/docs/5.3/configuration">https://laravel.com/docs/5.3/configuration</a> </p>
  </article>
  <script src="../../js/docs.js"></script>
 </body>
</html>