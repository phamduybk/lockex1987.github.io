<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <title>jQuery Comment Configuration</title>
    <style>
      table{border-collapse:collapse}td,th{border:1px solid #c0c0c0;padding:5px}
      
      
      
      .config-table label {
        display: block;
        color: #999;
      }
      
      .config-table code {
      color: #23A6F0;
      }
      
      .config-table th {
        text-align: left;
      }
    </style>
  </head>
  <body>
    <h2>Các cấu hình jQuery Comment</h2>
    <table class="config-table">
      <tbody>
        <tr>
          <th colspan="2">Người dùng hiện tại</th>
        </tr>
        <tr>
          <td><code>profilePictureURL</code></td>
          <td> Đường dẫn đến ảnh đại diện của người dùng hiện tại. Không bắt
            buộc nếu Font Awesome được sử dụng. </td>
        </tr>
        <tr>
          <td><code>currentUserIsAdmin</code></td>
          <td> Người dùng hiện tại có phải là quản trị hay không. Nếu là quản
            trị thì có thể sửa và xóa comment của người khác. </td>
        </tr>
        <tr>
          <th colspan="2">Ảnh (thay thế các icon được sử dụng)</th>
        </tr>
        <tr>
          <td><code>spinnerIconURL</code></td>
          <td> An <code>url</code> for spinner icon that is shown before
            comments have been fetched. Không bắt buộc nếu Font Awesome được sử
            dụng. </td>
        </tr>
        <tr>
          <td><code>upvoteIconURL</code></td>
          <td> An <code>url</code> for upvote icon that is used as a button for
            upvoting. Không bắt buộc nếu Font Awesome được sử dụng. </td>
        </tr>
        <tr>
          <td><code>replyIconURL</code></td>
          <td> An <code>url</code> for reply icon that is shown after the
            author of the comment if the comment is a reply. Không bắt buộc nếu
            Font Awesome được sử dụng. </td>
        </tr>
        <tr>
          <td><code>uploadIconURL</code></td>
          <td> An <code>url</code> for upload icon that is used as a button for
            uploading attachments. Không bắt buộc nếu Font Awesome được sử dụng.
          </td>
        </tr>
        <tr>
          <td><code>attachmentIconURL</code></td>
          <td> An <code>url</code> for attachment icon that is used as a symbor
            for attachments. Không bắt buộc nếu Font Awesome được sử dụng. </td>
        </tr>
        <tr>
          <td><code>fileIconURL</code></td>
          <td> An <code>url</code> for file icon that is used to indicate that
            a link is an attachment. Không bắt buộc nếu Font Awesome được sử
            dụng. </td>
        </tr>
        <tr>
          <td><code>noCommentsIconURL</code></td>
          <td> An <code>url</code> for no-comments icon that is shown if there
            are no comments to show. Không bắt buộc nếu Font Awesome được sử
            dụng. </td>
        </tr>
        <tr>
          <th colspan="2">Các nhãn hiển thị</th>
        </tr>
        <tr>
          <td><code>textareaPlaceholderText</code></td>
          <td> Placeholder của trường nhập comment </td>
        </tr>
        <tr>
          <td><code>newestText</code></td>
          <td> Text hiển thị ở tab "Các comment mới nhất" </td>
        </tr>
        <tr>
          <td><code>oldestText</code></td>
          <td> Text hiển thị ở tab "Các comment cũ nhất" </td>
        </tr>
        <tr>
          <td><code>popularText</code></td>
          <td> Text hiển thị ở tab "Các comment phổ biến" </td>
        </tr>
        <tr>
          <td><code>attachmentsText</code></td>
          <td> Text hiển thị ở tab "Đính kèm". Bình thường tab này không hiển
            thị, cần cấu hình enableAttachments: true. </td>
        </tr>
        <tr>
          <td><code>sendText</code></td>
          <td> Text của nút "Gửi comment" </td>
        </tr>
        <tr>
          <td><code>replyText</code></td>
          <td> Text của link "Reply" </td>
        </tr>
        <tr>
          <td><code>editText</code></td>
          <td> Text của link "Sửa comment" </td>
        </tr>
        <tr>
          <td><code>editedText</code></td>
          <td> Text của message "- Edited dd/mm/yyyy" khi comment được sửa. </td>
        </tr>
        <tr>
          <td><code>youText</code></td>
          <td> Tên của người vừa thêm comment. </td>
        </tr>
        <tr>
          <td><code>saveText</code></td>
          <td> Text của nút lưu khi sửa comment. </td>
        </tr>
        <tr>
          <td><code>deleteText</code></td>
          <td> Text của nút xóa </td>
        </tr>
        <tr>
          <td><code>viewAllRepliesText</code></td>
          <td> Text hiển thị tất cả trả lời. Khi có nhiều trả lời thì sẽ không
            hiển thị hết, mà chỉ hiển thị tối đa <code>maxRepliesVisible</code>.<br>
            Biến <code>__replyCount__</code> được sử dụng để thay thế cho số
            trả lời. </td>
        </tr>
        <tr>
          <td><code>hideRepliesText</code></td>
          <td> Text ẩn các trả lời. </td>
        </tr>
        <tr>
          <td><code>noCommentsText</code></td>
          <td> Text hiển thị khi không có comment nào. </td>
        </tr>
        <tr>
          <td><code>noAttachmentsText</code></td>
          <td> Text hiển thị khi không có file đính kèm nào. </td>
        </tr>
        <tr>
          <td><code>attachmentDropText</code></td>
          <td> A <code>string</code> that is used to inform the user where the
            attachments can be dropped <label>DEFAULT</label> <code>""</code><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    attachmentDropText: 'Drop here'
});
</pre></td>
        </tr>
        <tr>
          <th colspan="2">Màu sắc</th>
        </tr>
        <tr>
          <td><code>highlightColor</code></td>
          <td> A <code>css</code> value for the highlight color that is used
            for example to highlight active sorting button and comments by admin
            <label>DEFAULT</label> <code>#337AB7</code><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    highlightColor: '#23A6F0'
});
</pre></td>
        </tr>
        <tr>
          <td><code>deleteButtonColor</code></td>
          <td> A <code>css</code> value for the color of the delete button <label>DEFAULT</label>
            <code>#C9302C</code><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    deleteButtonColor: 'red'
});
</pre></td>
        </tr>
        <tr>
          <th colspan="2">Tính năng</th>
        </tr>
        <tr>
          <td><code>enableReplying</code></td>
          <td> true nếu cho phép trả lời comment. </td>
        </tr>
        <tr>
          <td><code>enableEditing</code></td>
          <td> true nếu cho phép sửa comment. </td>
        </tr>
        <tr>
          <td><code>enableUpvoting</code></td>
          <td> true nếu cho phép vote. </td>
        </tr>
        <tr>
          <td><code>enableDeleting</code></td>
          <td> true nếu cho phép xóa. </td>
        </tr>
        <tr>
          <td><code>enableDeletingCommentWithReplies</code></td>
          <td> A <code>boolean</code> value determing whether user is allowed
            to delete own comment that has replies (replies will be deleted as
            well) <label>DEFAULT</label> <code>true</code><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    enableDeletingCommentWithReplies: false
});
</pre></td>
        </tr>
        <tr>
          <td><code>enableAttachments</code></td>
          <td> true nếu cho phép đính kèm file. </td>
        </tr>
        <tr>
          <td><code>enableHashtags</code></td>
          <td> A <code>boolean</code> value determing whether hashtags are
            enabled. Enabling this functionality highlights the hashtags and the
            <code>hashtagClicked</code> callback function will be executed once
            the user has clicked a hashtag. <label>DEFAULT</label> <code>false</code><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    enableHashtags: true
});
</pre></td>
        </tr>
        <tr>
          <td><code>enablePinging</code></td>
          <td> A <code>boolean</code> value determing whether pinging users is
            enabled. Enabling this functionality highlights the pings and the <code>pingClicked</code>
            callback function will be executed once the user has clicked a ping.
            <br>
            <br>
            <label>N.B.</label>
            <ul>
              <li>The feature is depended on a javascript library called <a href="https://github.com/yuku-t/jquery-textcomplete">jquery-textcomplete</a></li>
              <li>You need to provide the list of users who can be pinged using
                the <code>getUsers</code> callback function</li>
              <li>jquery-comments assumes that the pings are sent to the server
                in format <code>@&lt;user_id&gt;</code>, for example <code>@145</code></li>
              <li>jquery-comments assumes that the pings are returned from the
                server in format <code>@&lt;user_fullname&gt;</code>, for
                example <code>@Bryan Connery</code> together with array of
                pinged user ids in same order they appear in the comment</li>
            </ul>
            <i>Switching the ping format is required in order to keep the link
              between the user model and the ping so that the ping won't get
              broken in case the user changes her name for example. On the other
              hand, we expect the server to return the ping in user friendly
              format so that the API will always return comments in a format
              that can be displayed without processing.</i> <label>DEFAULT</label>
            <code>false</code><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    enablePinging: true
});
</pre></td>
        </tr>
        <tr>
          <td><code>enableNavigation</code></td>
          <td> true nếu cho phép navigation. Nếu false thì sẽ không có các tab
            "Mới nhất", "Cũ nhất", "Phổ biến". </td>
        </tr>
        <tr>
          <td><code>postCommentOnEnter</code></td>
          <td> true nếu cho phép thêm comment khi nhấn Enter. </td>
        </tr>
        <tr>
          <td><code>forceResponsive</code></td>
          <td> A <code>boolean</code> value determing whether the main
            navigation elements are presented in a dropdown <label>DEFAULT</label>
            <code>false</code><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    forceResponsive: true
});
</pre></td>
        </tr>
        <tr>
          <td><code>readOnly</code></td>
          <td> true nếu không được thao tác gì (chỉ cho phép xem). </td>
        </tr>
        <tr>
          <th colspan="2">Field mappings</th>
        </tr>
        <tr>
          <td><code>fieldMappings</code></td>
          <td> Một từ điển để map giữa các trường của đối tượng comment mà thư
            viện sử dụng và các trường mà server trả về.<br>
            Key là trường sử dụng ở thư viện, value là trường ở API của server.<br>
            Ở các hàm callback, dữ liệu được map lại, do đó các trường ở API có
            thể khác với các trường yêu cầu của thư viện.<br>
            Các trường thư viện sử dụng là:
            <pre>id                      // bắt buộc
parent                  // bắt buộc nếu cho phép comment lồng nhau (enableReplying) 
created                 // bắt buộc (định dạng yyyy-mm-dd)
modified                // bắt buộc nếu cho phép sửa comment (enableEditing) (định dạng yyyy-mm-dd)
content                 // một trong hai trường content hoặc fileURL phải có
fileURL                 // một trong hai trường content hoặc fileURL phải có
file                    // bắt buộc nếu là đính kèm file (tên file?)
fileMimeType            // không bắt buộc
pings                   // bắt buộc nếu enablePinging
creator                 // ID người tạo, bắt buộc nếu enablePinging
fullname                // tên người tạo, bắt buộc
profileURL              // bình thường chỉ hiển thị tên người comment, có cái này sẽ hiển thị link đến trang của người comment, không bắt buộc
profilePictureURL       // không bắt buộc
isNew                   // không bắt buộc
createdByAdmin          // không bắt buộc
createdByCurrentUser    // để cho phép sửa (xóa) các comment cũ, ta thiết lập nó bằng true, không bắt buộc
upvoteCount             // bắt buộc nếu enableUpvoting
userHasUpvoted          // bắt buộc nếu enableUpvoting
</pre><label>DEFAULT (đang không y hệt mà chuyển từ snake_case sang camelCase)</label>
            <pre>fieldMappings: {
    id: 'id',
    parent: 'parent',
    created: 'created',
    modified: 'modified',
    content: 'content',
    file: 'file',
    fileURL: 'file_url',
    fileMimeType: 'file_mime_type',
    pings: 'pings',
    creator: 'creator',
    fullname: 'fullname',
    profileURL: 'profile_url',
    profilePictureURL: 'profile_picture_url',
    isNew: 'is_new',
    createdByAdmin: 'created_by_admin',
    createdByCurrentUser: 'created_by_current_user',
    upvoteCount: 'upvote_count',
    userHasUpvoted: 'user_has_upvoted'
}
</pre><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    fieldMappings: {
       parent: 'comment_id',
       modified: 'edited',
       fullname: 'name',
       profilePictureURL: 'user_image',
       upvoteCount: 'upvotes',
    }
});
</pre></td>
        </tr>
        <tr>
          <th colspan="2">Các hàm callback</th>
        </tr>
        <tr>
          <td><code>refresh</code></td>
          <td> A callback <code>function</code> that is called after the
            comments have been rendered <label>DEFAULT</label>
            <pre>function() {}
</pre><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    refresh: function() {
        $('#comments-container').addClass('rendered');
    }
});
</pre></td>
        </tr>
        <tr>
          <td><code>getComments</code></td>
          <td> Hàm callback để lấy comment từ server. Hàm cung cấp hai tham số <code>success</code>
            và <code>error</code> là hai hàm callback có thể gọi tiếp dựa vào
            kết quả từ server. Hàm callback <code>success</code> lấy một mảng
            các comment làm tham số. <label>DEFAULT</label>
            <pre>function(success, error) {
    success([]);
}
</pre><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    getComments: function(success, error) {
        $.ajax({
            type: 'get',
            url: '/api/comments/',
            success: function(commentsArray) {
                success(commentsArray);
            },
            error: error
        });
    }
});
</pre></td>
        </tr>
        <tr>
          <td><code>getUsers</code></td>
          <td> A callback <code>function</code> that is used to fetch the user
            array from the server. The callback provides both <code>success</code>
            and <code>error</code> callbacks which should be called based on
            the result from the server. The success callback takes the user
            array as a parameter. <label>DEFAULT</label>
            <pre>function(success, error) {
    success([]);
}
</pre><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    getUsers: function(success, error) {
        $.ajax({
            type: 'get',
            url: '/api/users/',
            success: function(userArray) {
                success(userArray)
            },
            error: error
        });
    }
});
</pre></td>
        </tr>
        <tr>
          <td><code>postComment</code></td>
          <td> Hàm callback khi thêm mới comment. Tham số đầu tiên là <code>commentJSON</code>
            chứa dữ liệu của comment mới. Có hai hàm callback <code>success</code>
            và <code>error</code> nên gọi tùy vào kết quả của server. Hàm <code>success</code>
            có tham số là đối tượng comment mới tạo. <label>DEFAULT</label>
            <pre>function(commentJSON, success, error) {
    success(commentJSON);
}
</pre><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    postComment: function(commentJSON, success, error) {
        $.ajax({
            type: 'post',
            url: '/api/comments/',
            data: commentJSON,
            success: function(comment) {
                success(comment);
            },
            error: error
        });
    }
});
</pre></td>
        </tr>
        <tr>
          <td><code>putComment</code></td>
          <td> Hàm callback được sử dụng để update comment đang có. Tham số đầu
            tiên <code>commentJSON</code> chứa các dữ liệu của comment đã cập
            nhật. Có hai hàm callback <code>success</code> và <code>error</code>
            nên được gọi tùy theo kết quả của server. Hàm <code>success</code>
            lấy đối tượng comment đã cập nhật làm tham số. <label>DEFAULT</label>
            <pre>function(commentJSON, success, error) {
    success(commentJSON);
}
</pre><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    putComment: function(commentJSON, success, error) {
        $.ajax({
            type: 'put',
            url: '/api/comments/' + commentJSON.id,
            data: commentJSON,
            success: function(comment) {
                success(comment);
            },
            error: error
        });
    }
});
</pre></td>
        </tr>
        <tr>
          <td><code>deleteComment</code></td>
          <td> Hàm callback được gọi để xóa comment.<br>
            Tham số đầu tiên <code>commentJSON</code> chứa dữ liệu của comment
            bị xóa.<br>
            Có hai hàm callback <code>success</code> và <code>error</code> nên
            được gọi tùy thuộc vào kết quả của server.<label>DEFAULT</label>
            <pre>function(commentJSON, success, error) {
    success();
}
</pre><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    deleteComment: function(commentJSON, success, error) {
        $.ajax({
            type: 'delete',
            url: '/api/comments/' + commentJSON.id,
            success: success,
            error: error
        });
    }
});
</pre></td>
        </tr>
        <tr>
          <td><code>upvoteComment</code></td>
          <td> A callback <code>function</code> that is used to create or
            delete an upvote. The first parameter of the callback is <code>commentJSON</code>
            that contains the data of the upvoted comment. The callback provides
            both <code>success</code> and <code>error</code> callbacks which
            should be called based on the result from the server. The success
            callback takes the updated comment as a parameter. <label>DEFAULT</label>
            <pre>function(commentJSON, success, error) {
    success(commentJSON);
}
</pre><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    upvoteComment: function(commentJSON, success, error) {
        var commentURL = '/api/comments/' + commentJSON.id;
        var upvotesURL = commentURL + '/upvotes/';

        if(commentJSON.userHasUpvoted) {
            $.ajax({
                type: 'post',
                url: upvotesURL,
                data: {
                    comment: commentJSON.id
                },
                success: function() {
                    success(commentJSON)
                },
                error: error
            });
        } else {
            $.ajax({
                type: 'delete',
                url: upvotesURL + upvoteId,
                success: function() {
                    success(commentJSON)
                },
                error: error
            });
        }
    }
});
</pre></td>
        </tr>
        <tr>
          <td><code>uploadAttachments</code></td>
          <td> A callback <code>function</code> that is used to upload
            attachments to the server. The first parameter of the callback is <code>commentArray</code>
            including all the attachments as comment models where <code>file</code>
            field contains the file to be uploaded. The server should return the
            url for the uploaded file in <code>fileURL</code> field. The
            callback provides both <code>success</code> and <code>error</code>
            callbacks which should be called based on the result from the
            server. The success callback takes an array of successfull uploads
            as a parameter. <label>DEFAULT</label>
            <pre>function(commentArray, success, error) {
    success(commentArray);
}
</pre><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    uploadAttachments: function(commentArray, success, error) {
        var responses = 0;
        var successfulUploads = [];

        var serverResponded = function() {
            responses++;

            // Check if all requests have finished
            if(responses == commentArray.length) {
                
                // Case: all failed
                if(successfulUploads.length == 0) {
                    error();

                // Case: some succeeded
                } else {
                    success(successfulUploads)
                }
            }
        }

        $(commentArray).each(function(index, commentJSON) {

            // Create form data
            var formData = new FormData();
            $(Object.keys(commentJSON)).each(function(index, key) {
                var value = commentJSON[key];
                if(value) formData.append(key, value);
            });

            $.ajax({
                url: '/api/comments/',
                type: 'POST',
                data: formData,
                cache: false,
                contentType: false,
                processData: false,
                success: function(commentJSON) {
                    successfulUploads.push(commentJSON);
                    serverResponded();
                },
                error: function(data) {
                    serverResponded();
                },
            });
        });
    }
});
</pre></td>
        </tr>
        <tr>
          <td><code>hashtagClicked</code></td>
          <td> A callback <code>function</code> that is called after user has
            clicked a hashtag <label>DEFAULT</label>
            <pre>function(hashtag) {}
</pre><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    hashtagClicked: function(hashtag) {
        location.hash = 'tags/' + hashtag
    }
});
</pre></td>
        </tr>
        <tr>
          <td><code>pingClicked</code></td>
          <td> A callback <code>function</code> that is called after user has
            clicked a ping <label>DEFAULT</label>
            <pre>function(ping) {}
</pre><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    pingClicked: function(ping) {
        location.hash = 'users/' + ping
    }
});
</pre></td>
        </tr>
        <tr>
          <th colspan="2">Định dạng</th>
        </tr>
        <tr>
          <td><code>textFormatter</code></td>
          <td> A callback <code>function</code> that is called for strings
            before inserting to DOM. Can be used for localization for instance.
            <label>DEFAULT</label>
            <pre>function(text) {
    return text;
}
</pre><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    textFormatter: function(text) {
        return i18n.translate(text);
    }
});
</pre></td>
        </tr>
        <tr>
          <td><code>timeFormatter</code></td>
          <td> Cấu hình định dạng thời gian.<br>
            Đang hiển thị mm/dd/yyyy.<br>
            Có thể dùng thư viện moment để hiển thị tương đối (bao nhiêu phút
            trước). <label>DEFAULT</label>
            <pre>function(time) {
    return new Date(time).toLocaleDateString();
}
</pre><label>EXAMPLE</label>
            <pre>$('#comments-container').comments({
    timeFormatter: function(time) {
        return moment(time).fromNow();
    }
});
</pre></td>
        </tr>
        <tr>
          <th colspan="2">Các cấu hình khác</th>
        </tr>
        <tr>
          <td><code>defaultNavigationSortKey</code></td>
          <td> Giá trị sắp xếp mặc định. Các giá trị có thể là <code>newest</code>,
            <code>oldest</code>, <code>popularity</code> và <code>attachments.</code>
          </td>
        </tr>
        <tr>
          <td><code>roundProfilePictures</code></td>
          <td> Thiết lập ảnh profile hình tròn.</td>
        </tr>
        <tr>
          <td><code>textareaRows</code></td>
          <td> Có bao nhiêu dòng ở trường thêm comment (khi chưa focus).</td>
        </tr>
        <tr>
          <td><code>textareaRowsOnFocus</code></td>
          <td> Có bao nhiêu dòng ở trường thêm comment (khi có focus).</td>
        </tr>
        <tr>
          <td><code>textareaMaxRows</code></td>
          <td> Số dòng tối đa của ô comment (độ cao tối đa của textarea, không
            phải chiều dài của text), hoặc là <code>false</code> nếu không giới
            hạn.</td>
        </tr>
        <tr>
          <td><code>maxRepliesVisible</code></td>
          <td> Số trả lời tối đa hiển thị dưới một comment.<br>
            Giả sử có 5 trả lời, nhưng ta cấu hình max <code>maxRepliesVisible</code>
            bằng 3 thì sẽ chỉ hiển thị 3 trả lời, 2 trả lời bị ẩn.<br>
            Chúng ta có thể hiện tất cả 3 trả lời bằng cách nhấn vào nút có nhãn
            là <code>viewAllRepliesText</code>.</td>
        </tr>
      </tbody>
    </table>
  </body>
</html>
