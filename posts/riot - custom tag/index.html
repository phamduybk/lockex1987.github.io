<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <title>Custom tag</title>
  </head>
  <body>
    <h2>Custom tag</h2>
    <p>Riot tag là các khối để build giao diện. Chúng ta sẽ chia giao diện trang
      web thành từng thành phần con, mỗi phần là 1 khối, 1 Riot tag.</p>
    <p>Bên trong Riot tag có thể có các thẻ HTML, thẻ script, thẻ style.</p>
    <p>Riot tag được dịch ra JavaScript.</p>
    <h3>Cú pháp</h3>
    <p>HTML được định nghĩa trước. Logic được đóng trong thẻ script (thẻ này có
      thể khai báo hoặc không).</p>
    <p>Tag có thể rỗng, hoặc chỉ có HTML, hoặc chỉ có JavaScript</p>
    <p>Dấu nháy là tùy chọn, &lt;foo bar={ baz }&gt; sẽ tự được dịch thành
      &lt;foo bar="{ baz }"&gt;</p>
    <p>Hỗ trợ cú pháp phương thức giống ES6. methodName() {} sẽ trở thành
      this.methodName = function() {}.bind(this) trong đó this trỏ tới instance
      của tag hiện tại.</p>
    <p>Cú pháp ngắn gọn cho class: class={ completed: done } sẽ được hiển thị là
      class="completed" khi giá trị của done là true.</p>
    <p>Các thuộc tính boolean (checked, selected,...) được bỏ qua khi biểu thức
      là falsy. Ví dụ &lt;input checked={ undifined }&gt; sẽ trở thành
      &lt;input&gt;.</p>
    <p>Tất cả các thuộc tính phải là chữ thường.</p>
    <h3>Pre-processor</h3>
    <p>Bạn có thể chỉ định một pre-processor với thuộc tính type. Ví dụ:</p>
    <pre>&lt;my-tag&gt;
  &lt;script type="coffee"&gt;
    # your coffeescript logic goes here
  &lt;/script&gt;
&lt;/my-tag&gt;</pre>
    <p>Các tùy chọn có là coffee, typescript, es6 và none.</p>
    <p>Style</p>
    <p>Bạn có thể cho một thẻ style vào trong Riot tag. Riot sẽ tự động lấy nó
      ra và thêm vào &lt;head&gt;. Việc này diễn ra chỉ 1 lần, dù tag có thể
      được khởi tạo nhiều lần.</p>
    <p>Scoped CSS</p>
    <p>Bạn có thể khai báo :scope ở trong style. Nó sẽ áp dụng cho tên của tag.</p>
    <p>Ví dụ:</p>
    <pre>&lt;todo&gt;

  &lt;!-- layout --&gt;
  &lt;h3&gt;{ opts.title }&lt;/h3&gt;

  &lt;style&gt;
    :scope { display: block }
    h3 { font-size: 120% }
    /** other tag specific styles **/
  &lt;/style&gt;

&lt;/todo&gt;</pre>
    <p>Sẽ dịch ra CSS là:</p>
    <pre>todo { display: block }</pre>
    <p>Ngoài ra, những style khác cũng sẽ được gói trong phạm vị thẻ Riot tag
      thôi. Ví dụ style của h3 sẽ trở thành:</p>
    <pre>todo h3 { font-size: 120% }</pre>
    <p>Mounting</p>
    <p>Một khi thẻ tag đã được tạo, bạn có thể mount nó vào page như sau:</p>
    <pre>&lt;body&gt;

  &lt;!-- place the custom tag anywhere inside the body --&gt;
  &lt;todo&gt;&lt;/todo&gt;

  &lt;!-- include riot.js --&gt;
  &lt;script src="riot.min.js"&gt;&lt;/script&gt;

  &lt;!-- include the tag javascript output generated with the riot compiler --&gt;
  &lt;script src="todo.js"&gt;&lt;/script&gt;

  &lt;!-- mount the tag --&gt;
  &lt;script&gt;riot.mount('todo')&lt;/script&gt;

&lt;/body&gt;</pre>
    <p>Riot tag trong trong body của trang cần được đóng bình thường:
      &lt;todo&gt;&lt;/todo&gt;. Không hỗ trợ tự đóng &lt;todo /&gt;.</p>
    <p>Các phương thức mount là:</p>
    <pre style="border: 1px solid green; border-radius: 5px;"><code id="output"
style="color: rgb(248, 248, 242); background-color: rgb(43, 43, 43); display: block; padding: 5px;"><span
style="color: rgb(212, 208, 171);">// mount all custom tags on the page</span>
riot.mount(<span style="color: rgb(171, 227, 56);">'*'</span>)

<span style="color: rgb(212, 208, 171);">// mount an element with a specific id</span>
riot.mount(<span style="color: rgb(171, 227, 56);">'#my-element'</span>)

<span style="color: rgb(212, 208, 171);">// mount selected elements</span>
riot.mount(<span style="color: rgb(171, 227, 56);">'todo, forum, comments'</span>)</code></pre>
    <p>Một trang có thể chứa nhiều instance của cùng một tag.</p>
    <p>Truy cập phần tử DOM</p>
    <p>Riot cho phép bạn truy cập các phần tử mà có thuộc tính ref thông qua đối
      tượng refs.</p>
    <p>Nếu bạn muốn truy cập DOM trong Riot, bạn cần hiểu vòng đời của tag. Chú
      ý rằng phần tử DOM sẽ không được khởi tạo cho đến khi sự kiện mount được
      diễn ra trước. Điều đó có nghĩa là nếu bạn có gắng select đối tượng trước
      đó (sự kiện mount) thì sẽ lỗi.</p>
    <pre style="border: 1px solid green; border-radius: 5px;"><code id="output"
style="color: rgb(248, 248, 242); background-color: rgb(43, 43, 43); display: block; padding: 5px;"><span
style="color: rgb(255, 160, 122);">&lt;<span style="color: rgb(255, 160, 122);">example-tag</span>&gt;</span>
  <span style="color: rgb(255, 160, 122);">&lt;<span style="color: rgb(255, 160, 122);">p</span> <span
style="color: rgb(255, 160, 122);">id</span>=<span style="color: rgb(171, 227, 56);">"findMe"</span>&gt;</span>Do I even Exist?<span
style="color: rgb(255, 160, 122);">&lt;/<span style="color: rgb(255, 160, 122);">p</span>&gt;</span>

  <span style="color: rgb(255, 160, 122);">&lt;<span style="color: rgb(255, 160, 122);">script</span>&gt;</span><span
style="color: rgb(248, 248, 242);">
  <span style="color: rgb(220, 198, 224);">var</span> test1 = <span style="color: rgb(245, 171, 53);">document</span>.getElementById(<span
style="color: rgb(171, 227, 56);">'findMe'</span>)
  <span style="color: rgb(245, 171, 53);">console</span>.log(<span style="color: rgb(171, 227, 56);">'test1'</span>, test1)  <span
style="color: rgb(212, 208, 171);">// Fails</span>

  <span style="color: rgb(220, 198, 224);">this</span>.on(<span style="color: rgb(171, 227, 56);">'update'</span>, <span
style="color: rgb(248, 248, 242);"><span style="color: rgb(220, 198, 224);">function</span>(<span
style="color: rgb(245, 171, 53);"></span>)</span>{
    <span style="color: rgb(220, 198, 224);">var</span> test2 = <span style="color: rgb(245, 171, 53);">document</span>.getElementById(<span
style="color: rgb(171, 227, 56);">'findMe'</span>)
    <span style="color: rgb(245, 171, 53);">console</span>.log(<span style="color: rgb(171, 227, 56);">'test2'</span>, test2) <span
style="color: rgb(212, 208, 171);">// Succeeds, fires on every update</span>
  })

  <span style="color: rgb(220, 198, 224);">this</span>.on(<span style="color: rgb(171, 227, 56);">'mount'</span>, <span
style="color: rgb(248, 248, 242);"><span style="color: rgb(220, 198, 224);">function</span>(<span
style="color: rgb(245, 171, 53);"></span>)</span>{
    <span style="color: rgb(220, 198, 224);">var</span> test3 = <span style="color: rgb(245, 171, 53);">document</span>.getElementById(<span
style="color: rgb(171, 227, 56);">'findMe'</span>)
    <span style="color: rgb(245, 171, 53);">console</span>.log(<span style="color: rgb(171, 227, 56);">'test3'</span>, test3) <span
style="color: rgb(212, 208, 171);">// Succeeds, fires once (per mount)</span>
  })
  </span><span style="color: rgb(255, 160, 122);">&lt;/<span style="color: rgb(255, 160, 122);">script</span>&gt;</span>
<span style="color: rgb(255, 160, 122);">&lt;/<span style="color: rgb(255, 160, 122);">example-tag</span>&gt;</span></code></pre>
    <p>Contexted DOM query</p>
    <p>Giờ chúng ta đã biết cách để lấy phần tử DOM bằng cách chờ các sự kiện
      update và mount. Chúng ta có thể hữu ích hơn bằng cách thêm ngữ cảnh vào
      câu query của chúng ta bằng phần tử root (Riot tag mà chúng ta tạo).</p>
    <pre style="border: 1px solid green; border-radius: 5px;"><code id="output"
style="color: rgb(248, 248, 242); background-color: rgb(43, 43, 43); display: block; padding: 5px;"><span
style="color: rgb(220, 198, 224);">this</span>.on(<span style="color: rgb(171, 227, 56);">'mount'</span>, <span
style="color: rgb(248, 248, 242);"><span style="color: rgb(220, 198, 224);">function</span>(<span
style="color: rgb(245, 171, 53);"></span>) </span>{
  <span style="color: rgb(212, 208, 171);">// Contexted jQuery</span>
  $(<span style="color: rgb(171, 227, 56);">'p'</span>, <span style="color: rgb(220, 198, 224);">this</span>.root)

  <span style="color: rgb(212, 208, 171);">// Contexted Query Selector</span>
  <span style="color: rgb(220, 198, 224);">this</span>.root.querySelectorAll(<span
style="color: rgb(171, 227, 56);">'p'</span>)
})</code></pre>
    <p>Tùy chọn</p>
    <p>Bạn có thể truyền các tùy chọn cho tag ở tham số thứ hai:</p>
    <pre>&lt;script&gt;
  riot.mount('todo', { title: 'My TODO app', items: [ ... ] })
&lt;/script&gt;</pre>
    <p>Dữ liệu truyền có thể là bất cứ gì, từ đối tượng, Flux store,... tùy theo
      thiết kế.</p>
    <p>Bên trong tag các tùy chọn có thể được ánh xạ với biến opts như sau:</p>
    <pre>&lt;my-tag&gt;

  &lt;!-- Options in HTML --&gt;
  &lt;h3&gt;{ opts.title }&lt;/h3&gt;

  // Options in JavaScript
  var title = opts.title

&lt;/my-tag&gt;</pre>
    <p>Vòng đời của tag</p>
    <p>Một tag được tạo theo trình tự sau:</p>
    <ol>
      <li>Tag được xây dựng</li>
      <li>JavaScript logic của tag được thực thi</li>
      <li>Các biểu thức HTML được tính toán</li>
      <li>Tag được mount vào trang và sự kiện mount được fire</li>
    </ol>
    <p>Sau khi tag đã được mount, các biểu thức được cập nhật như sau:</p>
    <ul>
      <li>Tự động cập nhật sau khi một event handler được gọi (trừ khi bạn thiết
        lập e.preventDefault HAY preventUpdate thành true trong event handler).</li>
      <li>Khi this.update() được gọi trong tag hiện tại</li>
      <li>Khi this.update() được gọi trong một tag cha ông nào đó</li>
      <li>Khi riot.update() được gọi toàn cục</li>
    </ul>
    <p>Sự kiện update fire mỗi khi tag được update</p>
    <p>Lắng nghe các sự kiện của vòng đời</p>
    <p>Bạn có thể lắng nghe các sự kiện khác nhau như sau:</p>
    <p>x</p>
    <p>Bạn có thể có nhiều listener cho cùng sự kiện.</p>
    <p>Mixin</p>
    <p>Mixin là một cách để chia sẻ tính năng giữa các tag một cách dễ dàng. Khi
      một tag được dịch vởi Riot, bất cứ mixin nào định nghĩa sẽ được thêm và
      sẵn sàng sử dụng trong tag.</p>
    <p>Biểu thức</p>
    <p>Mã HTML có thể kết hợp với các biểu thức bên trong dấu ngoặc nhọn:</p>
    <p>x</p>
    <p>Các biểu thức có thể thiết lập cho thuộc tính hoặc node con.</p>
    <p>x</p>
    <p>Các biểu thức là 100% JavaScript. Các ví dụ là:</p>
    <pre>{ title || 'Untitled' }
{ results ? 'ready' : 'loading' }
{ new Date() }
{ message.length &gt; 140 &amp;&amp; 'Message is too long' }
{ Math.round(rating) }</pre>
    <p>Mục tiêu là để các biểu thức càng nhỏ, càng đơn giản càng tốt. Nếu biểu
      thức phức tạp, bạn nên để logic vào trong sự kiện update. Ví dụ:</p>
    <pre>&lt;my-tag&gt;

  &lt;!-- the `val` is calculated below .. --&gt;
  &lt;p&gt;{ val }&lt;/p&gt;

  // ..on every update
  this.on('update', function() {
    this.val = some / complex * expression ^ here
  })
&lt;/my-tag&gt;</pre>
    <p>Thuộc tính boolean</p>
    <p><br>
    </p>
    <p><br>
    </p>
    <p><br>
    </p>
    <p>https://riot.js.org/guide/#mounting<br>
    </p>
    <p><br>
    </p>
    <p><br>
    </p>
  </body>
</html>
