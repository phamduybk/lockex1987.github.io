function getQueryString(){var e={};return location.search&&location.search.substr(1).replace(/\+/g,"%20").split("&").forEach(function(n){var t=n.split("=");e[decodeURIComponent(t[0])]=t[1]&&decodeURIComponent(t[1])}),e}function getSettings(e){return new Promise(function(n){chrome.storage.local.get(e||["voiceName","rate","pitch","volume","showHighlighting","languages"],n)})}function updateSettings(e){return new Promise(function(n){chrome.storage.local.set(e,n)})}function clearSettings(e){return new Promise(function(n){chrome.storage.local.remove(e||["voiceName","rate","pitch","volume","showHighlighting","languages"],n)})}function getState(e){return new Promise(function(n){chrome.storage.local.get(e,function(t){n(t[e])})})}function setState(e,n){var t={};return t[e]=n,new Promise(function(e){chrome.storage.local.set(t,e)})}function getVoices(){return new Promise(function(e){chrome.tts.getVoices(e)})}function isGoogleNative(e){return/^Google\s/.test(e)}function isGoogleTranslate(e){return/^GoogleTranslate /.test(e)}function isAmazonPolly(e){return/^Amazon /.test(e)}function isMicrosoftCloud(e){return/^Microsoft /.test(e)&&-1==e.indexOf(" - ")}function isRemoteVoice(e){return isAmazonPolly(e)||isGoogleTranslate(e)||isMicrosoftCloud(e)}function isPremiumVoice(e){return isAmazonPolly(e)||isMicrosoftCloud(e)}function executeFile(e){return new Promise(function(n,t){chrome.runtime.lastError=null,chrome.tabs.executeScript({file:e},function(e){chrome.runtime.lastError?t(new Error(chrome.runtime.lastError.message)):n(e)})})}function executeScript(e){return new Promise(function(n,t){chrome.runtime.lastError=null,chrome.tabs.executeScript({code:e},function(e){chrome.runtime.lastError?t(new Error(chrome.runtime.lastError.message)):n(e)})})}function insertCSS(e){return new Promise(function(n,t){chrome.runtime.lastError=null,chrome.tabs.insertCSS({file:e},function(e){chrome.runtime.lastError?t(new Error(chrome.runtime.lastError.message)):n(e)})})}function getBackgroundPage(){return new Promise(function(e){chrome.runtime.getBackgroundPage(e)})}function spread(e,n){return function(t){return e.apply(n,t)}}function callMethod(e,n){return function(t){return t[e].apply(t,n)}}function waitMillis(e){return new Promise(function(n){setTimeout(n,e)})}function parseLang(e){var n=e.toLowerCase().replace(/_/g,"-").split(/-/,2);return{lang:n[0],rest:n[1]}}function formatError(e){var n=chrome.i18n.getMessage(e.code);return n&&(n=n.replace(/{(\w+)}/g,function(n,t){return e[t]})),n}function urlEncode(e){if(null==e)return null;var n=[];for(var t in e)n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&")}function ajaxGet(e){return new Promise(ajaxGetCb.bind(null,e))}function ajaxGetCb(e,n,t){var r=new XMLHttpRequest;r.open("GET",e,!0),r.onreadystatechange=function(){r.readyState==XMLHttpRequest.DONE&&(200==r.status?n(r.responseText):t&&t(new Error(r.responseText)))},r.send(null)}function ajaxPost(e,n,t){return new Promise(function(r,a){var o=new XMLHttpRequest;o.open("POST",e,!0),o.setRequestHeader("Content-type","json"==t?"application/json":"application/x-www-form-urlencoded"),o.onreadystatechange=function(){o.readyState==XMLHttpRequest.DONE&&(200==o.status?r(o.responseText):a(new Error(o.responseText)))},o.send("json"==t?JSON.stringify(n):urlEncode(n))})}function objectAssign(e,n){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var a=arguments[r];if(null!=a)for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(t[o]=a[o])}return t}function domReady(){return new Promise(function(e){$(e)})}function setI18nText(){$("[data-i18n]").each(function(){var e=$(this).data("i18n"),n=chrome.i18n.getMessage(e);$(this).is("input")?$(this).val(n):$(this).text(n)})}function escapeHtml(e){return e.replace(/[&<>"'`=\/]/g,function(e){return config.entityMap[e]})}function getBrowser(){return/Opera|OPR\//.test(navigator.userAgent)?"opera":/firefox/i.test(navigator.userAgent)?"firefox":"chrome"}function getHotkeySettingsUrl(){switch(config.browser){case"opera":return"opera://settings/configureCommands";case"chrome":return"chrome://extensions/configureCommands";default:return chrome.runtime.getURL("shortcuts.html")}}function Speech(e,n){function t(){return new Promise(function(e){w.isSpeaking(function(n){e("PLAYING"==S?n?"PLAYING":"LOADING":"PAUSED")})})}function r(){return{index:b,texts:e}}function a(){return b>=e.length?(S="IDLE",n.onEnd&&n.onEnd(),Promise.resolve()):"PAUSED"==S?(S="PLAYING",w.resume(),Promise.resolve()):(S=new String("PLAYING"),S.startTime=(new Date).getTime(),g(e[b],function(){S="IDLE",w.setNextStartTime((new Date).getTime()+T,n),b++,a()},function(e){S="IDLE",n.onEnd&&n.onEnd(e)}).then(function(){e[b+1]&&w.prefetch(e[b+1],n)}))}function o(){return clearTimeout(y),y=setTimeout(a,750),Promise.resolve()}function i(){return w.pause?(w.pause(),S="PAUSED",Promise.resolve()):s()}function s(){return w.stop(),S="IDLE",Promise.resolve()}function l(){return b+1<e.length?(b++,o()):Promise.reject(new Error("Can't forward, at end"))}function c(){return"PLAYING"==S&&(new Date).getTime()-S.startTime>3e3?a():b>0?(b--,a()):Promise.reject(new Error("Can't rewind, at beginning"))}function u(){b=e.length&&e.length-1}function g(e,t,r){return new Promise(function(a){w.speak(e,{voiceName:n.voiceName,lang:n.lang,rate:n.rate,pitch:n.pitch,volume:n.volume,requiredEventTypes:["start","end"],desiredEventTypes:["start","end","error"]},function(e){"start"==e.type?a():"end"==e.type?t():"error"==e.type&&r(new Error(e.errorMessage||"Unknown TTS error"))})})}function d(e,n){function t(e){return i(n.getParagraphs(e),r)}function r(e){return i(n.getSentences(e),a)}function a(e){return i(n.getPhrases(e),o)}function o(t){for(var r=n.getWords(t),a=Math.min(Math.ceil(r.length/2),e),o=[];r.length;)o.push(r.slice(0,a).join("")),r=r.slice(a);return o}function i(t,r){var a=[],o={parts:[],wordCount:0},i=function(){o.parts.length&&(a.push(o.parts.join("")),o={parts:[],wordCount:0})};return t.forEach(function(t){var s=n.getWords(t).length;if(s>e){i();for(var l=r(t),c=0;c<l.length;c++)a.push(l[c])}else o.wordCount+s>e&&i(),o.parts.push(t),o.wordCount+=s}),i(),a}this.breakText=t}function m(e,n,t){function r(e){return l(n.getParagraphs(e),a,t)}function a(e){return l(n.getSentences(e),o)}function o(e){return l(n.getPhrases(e),i)}function i(e){return l(n.getWords(e),s)}function s(n){for(var t=[];n;)t.push(n.slice(0,e)),n=n.slice(e);return t}function l(n,t,r){var a=[],o={parts:[],charCount:0},i=function(){o.parts.length&&(a.push(o.parts.join("")),o={parts:[],charCount:0})};return n.forEach(function(n){var s=n.length;if(s>e){i();for(var l=t(n),c=0;c<l.length;c++)a.push(l[c])}else o.charCount+s>(r||e)&&i(),o.parts.push(n),o.charCount+=s}),i(),a}this.breakText=r}function p(){function e(e){for(var n=[],t=0;t<e.length;t+=2)t+1<e.length?n.push(e[t]+e[t+1]):e[t]&&n.push(e[t]);return n}this.getParagraphs=function(n){return e(n.split(/((?:\r?\n\s*){2,})/))},this.getSentences=function(n){return e(n.split(/([.!?]+[\s\u200b]+)/))},this.getPhrases=function(n){return e(n.split(/([,;:]\s+|\s-+\s+|—\s*)/))},this.getWords=function(e){for(var n=e.trim().split(/([~@#%^*_+=<>]|[\s\-—\/]+|\.(?=\w{2,})|,(?=[0-9]))/),t=[],r=0;r<n.length;r+=2)n[r]&&t.push(n[r]),r+1<n.length&&(/^[~@#%^*_+=<>]$/.test(n[r+1])?t.push(n[r+1]):t.length&&(t[t.length-1]+=n[r+1]));return t}}function h(){function e(e){for(var n=[],t=0;t<e.length;t+=2)t+1<e.length?n.push(e[t]+e[t+1]):e[t]&&n.push(e[t]);return n}this.getParagraphs=function(n){return e(n.split(/((?:\r?\n\s*){2,})/))},this.getSentences=function(n){return e(n.split(/([.!?]+[\s\u200b]+|[\u3002\uff01]+)/))},this.getPhrases=function(n){return e(n.split(/([,;:]\s+|[\u2025\u2026\u3000\u3001\uff0c\uff1b]+)/))},this.getWords=function(e){return e.replace(/\s+/g,"").split("")}}function f(e,n){var t;this.speak=function(r,a,o){clearTimeout(t),t=setTimeout(function(){e.stop(),o({type:"end",charIndex:r.length})},n),e.speak(r,a,function(e){"end"!=e.type&&"error"!=e.type||clearTimeout(t),o(e)})},this.stop=function(){clearTimeout(t),e.stop()},this.isSpeaking=e.isSpeaking,this.prefetch=e.prefetch,this.setNextStartTime=e.setNextStartTime}function v(){this.speak=function(e,n,t){chrome.tts.speak(e,Object.assign({onEvent:t},n))},this.stop=chrome.tts.stop,this.pause=chrome.tts.pause,this.resume=chrome.tts.resume,this.isSpeaking=chrome.tts.isSpeaking,this.prefetch=function(e,n){isRemoteVoice(n.voiceName)&&remoteTtsEngine.prefetch(e,n)},this.setNextStartTime=function(e,n){isRemoteVoice(n.voiceName)&&remoteTtsEngine.setNextStartTime(e)}}n.rate=(n.rate||1)*(isGoogleTranslate(n.voiceName)?1.2:1);for(var _=0;_<e.length;_++)/\w$/.test(e[_])&&(e[_]+=".");e.length&&(e=function(e){var t=/^zh|ko|ja/.test(n.lang),r=t?new h:new p;if(isGoogleNative(n.voiceName)){return new d((/^de/.test(n.lang)?32:36)*(t?2:1)*n.rate,r).breakText(e)}return isGoogleTranslate(n.voiceName)?new m(200,r).breakText(e):new m(500,r,200).breakText(e)}(e.join("\n\n")));var y,w=n.engine||(isGoogleNative(n.voiceName)?new f(new v,16e3):new v),T=isGoogleTranslate(n.voiceName)?0:650/n.rate,S="IDLE",b=0;this.options=n,this.play=a,this.pause=i,this.stop=s,this.getState=t,this.getPosition=r,this.forward=l,this.rewind=c,this.gotoEnd=u}function RemoteTTS(e){function n(n,t,r){return e+"/read-aloud/speak/"+t+"/"+encodeURIComponent(r)+"?q="+encodeURIComponent(n)}var t,r=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),a=window.ttsAudio||(window.ttsAudio=document.createElement("AUDIO")),o=document.createElement("AUDIO"),i=0;this.speak=function(e,o,s){o.volume||(o.volume=1),o.rate||(o.rate=1),s||(s=o.onEvent),a.pause(),r||(a.volume=o.volume,a.defaultPlaybackRate=o.rate),a.src=n(e,o.lang,o.voiceName),a.oncanplay=function(){var e=i-(new Date).getTime();e>0?t=setTimeout(a.play.bind(a),e):a.play()},a.onplay=s.bind(null,{type:"start",charIndex:0}),a.onended=s.bind(null,{type:"end",charIndex:e.length}),a.onerror=function(){s({type:"error",errorMessage:a.error.message})},a.load()},this.isSpeaking=function(e){e(a.currentTime&&!a.paused&&!a.ended)},this.pause=this.stop=function(){clearTimeout(t),a.pause()},this.resume=function(){a.play()},this.prefetch=function(e,t){o.src=n(e,t.lang,t.voiceName)},this.setNextStartTime=function(e){i=e||0}}var manifest={manifest_version:2,name:"__MSG_extension_name__",short_name:"__MSG_extension_short_name__",description:"__MSG_extension_description__",version:"1.2.12",default_locale:"en",browser_action:{default_icon:"img/icon.png",default_popup:"popup.html"},icons:{16:"img/icon.png",48:"img/icon.png",128:"img/icon.png"},permissions:["activeTab","tts","storage","ttsEngine","contextMenus","https://support.lsdsoftware.com/"],content_security_policy:"script-src 'self' 'unsafe-eval'; object-src 'self'",web_accessible_resources:["img/*","js/jquery-ui.min.js","css/jquery-ui.min.css","css/images/*","js/googleDocsUtil.js"],background:{scripts:["js/es6-promise.auto.min.js","js/defaults.js","js/speech.js","js/document.js","js/googletr_tts.js","js/events.js"],persistent:!1},options_page:"options.html",commands:{play:{suggested_key:{default:"Alt+Shift+P"},description:"play/pause"},stop:{suggested_key:{default:"Alt+Shift+S"},description:"stop"},forward:{suggested_key:{default:"Alt+Shift+N"},description:"forward"},rewind:{suggested_key:{default:"Alt+Shift+B"},description:"rewind"}},tts_engine:{voices:[{voice_name:"GoogleTranslate Afrikaans",lang:"af",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Albanian",lang:"sq",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Arabic",lang:"ar",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Armenian",lang:"hy",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Bengali",lang:"bn",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Bosnian",lang:"bs",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Catalan",lang:"ca",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Chinese",lang:"zh-CN",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Croatian",lang:"hr",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Czech",lang:"cs",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Danish",lang:"da",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Dutch",lang:"nl",event_types:["start","end","error"]},{voice_name:"GoogleTranslate English",lang:"en",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Esperanto",lang:"eo",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Finnish",lang:"fi",event_types:["start","end","error"]},{voice_name:"GoogleTranslate French",lang:"fr",event_types:["start","end","error"]},{voice_name:"GoogleTranslate German",lang:"de",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Greek",lang:"el",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Hebrew",lang:"he",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Hindi",lang:"hi",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Hungarian",lang:"hu",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Icelandic",lang:"is",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Indonesian",lang:"id",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Italian",lang:"it",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Japanese",lang:"ja",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Khmer",lang:"km",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Korean",lang:"ko",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Latin",lang:"la",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Latvian",lang:"lv",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Macedonian",lang:"mk",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Nepali",lang:"ne",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Norwegian",lang:"no",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Polish",lang:"pl",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Portuguese",lang:"pt",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Romanian",lang:"ro",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Russian",lang:"ru",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Serbian",lang:"sr",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Sinhala",lang:"si",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Slovak",lang:"sk",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Spanish",lang:"es",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Swahili",lang:"sw",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Swedish",lang:"sv",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Tamil",lang:"ta",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Thai",lang:"th",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Turkish",lang:"tr",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Ukrainian",lang:"uk",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Vietnamese",lang:"vi",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Welsh",lang:"cy",event_types:["start","end","error"]},{voice_name:"Amazon Australian English (Nicole)",lang:"en-AU",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Australian English (Russell)",lang:"en-AU",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Brazilian Portuguese (Ricardo)",lang:"pt-BR",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Brazilian Portuguese (Vitoria)",lang:"pt-BR",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon British English (Amy)",lang:"en-GB",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon British English (Brian)",lang:"en-GB",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon British English (Emma)",lang:"en-GB",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Canadian French (Chantal)",lang:"fr-CA",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Castilian Spanish (Conchita)",lang:"es-ES",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Castilian Spanish (Enrique)",lang:"es-ES",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Danish (Mads)",lang:"da-DK",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Danish (Naja)",lang:"da-DK",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Dutch (Lotte)",lang:"nl-NL",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Dutch (Ruben)",lang:"nl-NL",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon French (Celine)",lang:"fr-FR",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon French (Mathieu)",lang:"fr-FR",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon German (Hans)",lang:"de-DE",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon German (Marlene)",lang:"de-DE",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon German (Vicki)",lang:"de-DE",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Icelandic (Dora)",lang:"is-IS",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Icelandic (Karl)",lang:"is-IS",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Indian English (Aditi)",lang:"en-IN",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Indian English (Raveena)",lang:"en-IN",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Italian (Carla)",lang:"it-IT",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Italian (Giorgio)",lang:"it-IT",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Japanese (Mizuki)",lang:"ja-JP",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Japanese (Takumi)",lang:"ja-JP",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Korean (Seoyeon)",lang:"ko-KR",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Norwegian (Liv)",lang:"nb-NO",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Polish (Ewa)",lang:"pl-PL",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Polish (Jacek)",lang:"pl-PL",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Polish (Jan)",lang:"pl-PL",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Polish (Maja)",lang:"pl-PL",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Portuguese (Cristiano)",lang:"pt-PT",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Portuguese (Ines)",lang:"pt-PT",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Romanian (Carmen)",lang:"ro-RO",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Russian (Maxim)",lang:"ru-RU",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Russian (Tatyana)",lang:"ru-RU",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Swedish (Astrid)",lang:"sv-SE",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Turkish (Filiz)",lang:"tr-TR",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon US English (Ivy)",lang:"en-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon US English (Joanna)",lang:"en-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon US English (Joey)",lang:"en-US",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon US English (Justin)",lang:"en-US",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon US English (Kendra)",lang:"en-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon US English (Kimberly)",lang:"en-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon US English (Matthew)",lang:"en-US",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon US English (Salli)",lang:"en-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon US Spanish (Miguel)",lang:"es-US",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon US Spanish (Penelope)",lang:"es-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Welsh (Gwyneth)",lang:"cy-GB",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Welsh English (Geraint)",lang:"en-GB-WLS",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Australian English (Catherine)",lang:"en-AU",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Australian English (James)",lang:"en-AU",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Belgian Dutch (Bart)",lang:"nl-BE",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Brazilian Portuguese (Daniel)",lang:"pt-BR",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Brazilian Portuguese (Maria)",lang:"pt-BR",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft British English (George)",lang:"en-GB",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft British English (Hazel)",lang:"en-GB",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft British English (Susan)",lang:"en-GB",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Canadian English (Linda)",lang:"en-CA",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Canadian English (Richard)",lang:"en-CA",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Canadian French (Caroline)",lang:"fr-CA",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Canadian French (Claude)",lang:"fr-CA",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Canadian French (Nathalie)",lang:"fr-CA",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Catalan (Herena)",lang:"ca-ES",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Chinese (Huihui)",lang:"zh-CN",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Chinese (Kangkang)",lang:"zh-CN",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Chinese (Yaoyao)",lang:"zh-CN",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft ChineseTW (Hanhan)",lang:"zh-TW",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft ChineseTW (Yating)",lang:"zh-TW",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft ChineseTW (Zhiwei)",lang:"zh-TW",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Danish (Helle)",lang:"da-DK",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Dutch (Frank)",lang:"nl-NL",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Finnish (Heidi)",lang:"fi-FI",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft French (Hortense)",lang:"fr-FR",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft French (Julie)",lang:"fr-FR",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft French (Paul)",lang:"fr-FR",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft German (Hedda)",lang:"de-DE",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft German (Katja)",lang:"de-DE",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft German (Stefan)",lang:"de-DE",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Indian English (Heera)",lang:"en-IN",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Indian English (Ravi)",lang:"en-IN",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Italian (Cosimo)",lang:"it-IT",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Italian (Elsa)",lang:"it-IT",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Japanese (Ayumi)",lang:"ja-JP",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Japanese (Haruka)",lang:"ja-JP",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Japanese (Ichiro)",lang:"ja-JP",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Japanese (Sayaka)",lang:"ja-JP",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Korean (Heami)",lang:"ko-KR",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Mexican Spanish (Raul)",lang:"es-MX",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Mexican Spanish (Sabina)",lang:"es-MX",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Norwegian (Jon)",lang:"nb-NO",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Polish (Adam)",lang:"pl-PL",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Polish (Paulina)",lang:"pl-PL",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Portuguese (Helia)",lang:"pt-PT",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Russian (Irina)",lang:"ru-RU",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Russian (Pavel)",lang:"ru-RU",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Spanish (Helena)",lang:"es-ES",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Spanish (Laura)",lang:"es-ES",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Spanish (Pablo)",lang:"es-ES",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Swedish (Bengt)",lang:"sv-SE",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Turkish (Tolga)",lang:"tr-TR",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft US English (David)",lang:"en-US",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft US English (Mark)",lang:"en-US",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft US English (Zira)",lang:"en-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Vietnamese (An)",lang:"vi-VI",gender:"male",event_types:["start","end","error"]}]}},config={serviceUrl:"https://support.lsdsoftware.com",entityMap:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},browser:getBrowser()},defaults={rate:1,pitch:1,volume:1,showHighlighting:0};"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:objectAssign,writable:!0,configurable:!0}),function(){function e(e){window.docReady||(window.docReady=t()),window.docReady.then(function(t){n(e,t)})}function n(e,n){function t(e,n){var t=n.request;if(e[t.method]){var r=e[t.method](t);Promise.resolve(r).then(function(e){l.postMessage({id:n.id,response:e})})}}function r(e){var t=document.documentElement.lang||$("html").attr("xml:lang");return t&&(t=t.replace(/_/g,"-")),"en"!=t&&"en-US"!=t||(t=null),{redirect:n.redirect,url:location.href,title:document.title,lang:t}}function a(e){return i()?-100:n.getCurrentIndex()}function o(e){return e.index<0?-100==e.index?i().split(h.paraSplitter):null:Promise.resolve(n.getTexts(e.index,e.quietly)).then(function(n){return n&&(n=n.map(s),e.quietly||console.log(n.join("\n\n"))),n})}function i(){return window.getSelection().toString().trim()}function s(e){return e.replace(/https?:\/\/\S+/g,"this URL.")}var l=chrome.runtime.connect({name:e});l.onMessage.addListener(t.bind(null,{raGetInfo:r,raGetCurrentIndex:a,raGetTexts:o}))}function t(){function e(){return"docs.google.com"==location.hostname?$(".kix-appview-editor").length?new r:$(".drive-viewer-paginated-scrollable").length?new a:new u:"drive.google.com"==location.hostname?new a:/^read\.amazon\./.test(location.hostname)?new o:"www.quora.com"==location.hostname?new s:"www.khanacademy.org"==location.hostname?new l:"bookshelf.vitalsource.com"==location.hostname?new c:location.pathname.match(/\.pdf$/)?new i(location.href):$("embed[type='application/pdf']").length?new i($("embed[type='application/pdf']").attr("src")):new u}return function(){return new Promise(function(e){$(e)})}().then(e).then(function(e){return Promise.resolve(e.ready).then(function(){return e})})}function r(){function e(){return $(".kix-paragraphrenderer",this).get().map(g).filter(d)}var n=$(".kix-appview-editor").get(0),t=$(".kix-page");this.ready=h.loadScript(chrome.runtime.getURL("js/googleDocsUtil.js")),this.getCurrentIndex=function(){if(googleDocsUtil.getGoogleDocument().selectedText)return 9999;for(var e=0;e<t.length&&!(t.eq(e).position().top>n.scrollTop+$(n).height()/2);e++);return e-1},this.getTexts=function(r,a){if(9999==r){return[googleDocsUtil.getGoogleDocument().selectedText]}var o=t.get(r);if(o){var i=n.scrollTop;return n.scrollTop=$(o).position().top,p(e.bind(o),2e3).then(function(e){return a&&(n.scrollTop=i),e})}return null}}function a(){function e(){return m($("p",this).get().map(g).filter(d))}var n=$(".drive-viewer-paginated-scrollable").get(0),t=$(".drive-viewer-paginated-page");this.getCurrentIndex=function(){for(var e=0;e<t.length&&!(t.eq(e).position().top>n.scrollTop+$(n).height()/2);e++);return e-1},this.getTexts=function(r,a){var o=t.get(r);if(o){var i=n.scrollTop;return n.scrollTop=$(o).position().top,p(e.bind(o),3e3).then(function(e){return a&&(n.scrollTop=i),e})}return null}}function o(){function e(){var e=[];o.filter(function(e){return"hidden"!=e.style.visibility}).forEach(function(n){var t=$(n).height();$("h1, h2, h3, h4, h5, h6, .was-a-p",n.contentDocument).each(function(){var n=$(this).offset().top;$(this).height();n>=0&&n<t&&e.push($(this).text())})});for(var t=[],r=0;r<e.length;r++)e[r]!=(t.length?t[t.length-1]:n)&&t.push(e[r]);return n=t[t.length-1],t}var n,t=document.getElementById("KindleReaderIFrame").contentDocument,r=t.getElementById("kindleReader_pageTurnAreaRight"),a=t.getElementById("kindleReader_pageTurnAreaLeft"),o=[t.getElementById("column_0_frame_0"),t.getElementById("column_0_frame_1"),t.getElementById("column_1_frame_0"),t.getElementById("column_1_frame_1")],i=0;this.getCurrentIndex=function(){return i=0},this.getTexts=function(n){for(;i<n;i++)$(r).click();for(;i>n;i--)$(a).click();return p(e,4e3)}}function i(e){function n(){return new Promise(function(e,n){$.ajax(f+"viewer.html",{dataType:"text",success:function(n){var t=n.indexOf(">",n.indexOf("<body"))+1,r=n.indexOf("</body>");document.body.innerHTML=n.slice(t,r),e()},error:function(){n(new Error("Failed to load viewer html"))}})})}function t(){$("<link>").appendTo("head").attr({rel:"resource",type:"application/l10n",href:f+"locale/locale.properties"})}function r(){var e=function(e){var n=PDFJS[e];Object.defineProperty(PDFJS,e,{enumerable:!0,configurable:!0,get:function(){return f+n},set:function(e){n=e}})};e("imageResourcesPath"),e("workerSrc"),e("cMapUrl")}function a(e){return e.replace("compressed.tracemonkey-pldi-09.pdf","")}function o(){return PDFViewerApplication.open(e).then(function(){return new Promise(function(e){PDFViewerApplication.eventBus.on("documentload",e)})})}function i(){if(!$(".ra-loading-icon").length){var e=$("<div>").addClass("ra-loading-icon").css({position:"absolute",left:"50%",top:"50%"}).appendTo(document.body)
;$("<img>").attr("src",chrome.runtime.getURL("img/throb.gif")).css({position:"relative",width:48,left:-24,top:-24}).appendTo(e)}$(".ra-loading-icon").show()}function s(){$(".ra-loading-icon").hide()}function l(e){return e.getTextContent().then(function(e){for(var n=[],t=0;t<e.items.length;t++)(0==n.length||t>0&&e.items[t-1].transform[5]!=e.items[t].transform[5])&&n.push(""),n[n.length-1]+=e.items[t].str;return n.map(function(e){return e.trim()})}).then(m)}function c(){var e=$("<div>");$("<p>").text(g({code:"uploadpdf_message1",extension_name:chrome.i18n.getMessage("extension_short_name")})).css("color","blue").appendTo(e),$("<p>").text(g({code:"uploadpdf_message2",extension_name:chrome.i18n.getMessage("extension_short_name")})).appendTo(e);var n=$("<form>").attr("action","https://support2.lsdsoftware.com/dropmeafile-readaloud/upload").attr("method","POST").attr("enctype","multipart/form-data").on("submit",function(){t.prop("disabled",!0)}).appendTo(e);$("<input>").attr("type","file").attr("name","fileToUpload").attr("accept","application/pdf").on("change",function(){t.prop("disabled",!$(this).val())}).appendTo(n),$("<br>").appendTo(n),$("<br>").appendTo(n);var t=$("<input>").attr("type","submit").attr("value",chrome.i18n.getMessage("uploadpdf_submit_button")).prop("disabled",!0).appendTo(n);return e.dialog({title:chrome.i18n.getMessage("extension_short_name"),width:450,modal:!0,autoOpen:!1}),{show:function(){e.dialog("open")}}}function u(){Promise.resolve().then(function(){if(!$.ui)return h.loadCss(chrome.runtime.getURL("css/jquery-ui.min.css")).then(h.loadScript.bind(null,chrome.runtime.getURL("js/jquery-ui.min.js")))}).then(function(){var e=$("<div>");$("<p>").text("I can't find any text to read.  This is probably because this PDF contains scanned images of text instead of the actual text.  If you're unable to select any text using your mouse, it means they are images.").css("color","blue").appendTo(e),e.dialog({title:chrome.i18n.getMessage("extension_short_name"),width:450})})}function g(e){var n=chrome.i18n.getMessage(e.code);return n&&(n=n.replace(/{(\w+)}/g,function(n,t){return e[t]})),n}var d,p,f="https://assets.lsdsoftware.com/read-aloud/pdf-viewer/web/";/^file:/.test(e)?this.ready=h.loadCss(chrome.runtime.getURL("css/jquery-ui.min.css")).then(h.loadScript.bind(null,chrome.runtime.getURL("js/jquery-ui.min.js"))).then(c).then(function(e){d=e}):this.ready=h.loadCss(f+"viewer.css").then(n).then(i).then(t).then(h.loadScript.bind(null,f+"../build/pdf.js")).then(r).then(h.loadScript.bind(null,f+"pdf.viewer.js",a)).then(o).then(s),this.getCurrentIndex=function(){if(d)return 0;var e=PDFViewerApplication.page;return e?e-1:0},this.getTexts=function(e,n){if(d)return d.show(),null;var t=PDFViewerApplication.pdfDocument;return e<t.numPages?(n||(PDFViewerApplication.page=e+1),t.getPage(e+1).then(l).then(function(e){return e.length&&(p=!0),e})):(p||u(),null)}}function s(){function e(){var e=[],n=$(".QuestionArea .question_qtext").get(0);return n&&e.push(n.innerText),$(".AnswerBase").each(function(){n=$(this).find(".feed_item_answer_user .user").get(0),n&&e.push("Answer by "+n.innerText),n=$(this).find(".rendered_qtext").get(0),n&&e.push.apply(e,n.innerText.split(h.paraSplitter)),(n=$(this).find(".AnswerFooter").get(0))&&e.push(n.innerText)}),e}this.getCurrentIndex=function(){return 0},this.getTexts=function(n){return 0==n?e():null}}function l(){function e(){return $("h1:first").add($("> :not(ul, ol), > ul > li, > ol > li",".paragraph:not(.paragraph .paragraph)")).get().map(function(e){var n=g(e);return $(e).is("li")?$(e).index()+1+". "+n:n})}this.getCurrentIndex=function(){return 0},this.getTexts=function(n){return 0==n?e():null}}function c(){this.redirect=!0,this.getCurrentIndex=function(){return 0},this.getTexts=function(){var e=$("#jigsaw-placeholder > iframe").get(0);return e&&(location.href=e.src),null}}function u(){function e(){var e=new Date,a=n(100),o=a.reduce(function(e,n){return e+g(n).length},0);if(console.log("Found",a.length,"blocks",o,"chars in",new Date-e,"ms"),o<1e3){a=n(3);var i=a.map(g);console.log("Using lower threshold, found",a.length,"blocks",i.join("").length,"chars");for(var s,c,u=3;u<i.length&&!s;u++){var m=t(i,0,u);i[u].length>m.mean+2*m.stdev&&(s=u)}for(var u=i.length-4;u>=0&&!c;u--){var m=t(i,u+1,i.length);i[u].length>m.mean+2*m.stdev&&(c=u+1)}(s||c)&&(a=a.slice(s||0,c),console.log("Trimmed",s,c))}for(var h=[],u=0;u<a.length;u++)h.push.apply(h,l(a[u],a[u-1])),h.push(a[u]);$(h).addClass("read-aloud");var i=h.map(r);return p(i).filter(d)}function n(e){var n="h1, h2, h3, h4, h5, h6, p, a[href], "+f,t=function(e){return 3==e.nodeType&&e.nodeValue.trim().length>=3},r=function(n){return 1==n.nodeType&&$(n).is("p")&&g(n).length>=e},a=function(n){return m(n,t)&&g(n).length>=e},o=function(e){return m(e,r)},i=function(e){var t=$(e).children(":not("+n+")").get();return t.some(a)||t.some(o)||t.some(i)},s=function(e,n){n&&$(e).data("read-aloud-multi-block",!0),c.push(e)},l=function(){if($(this).is("frame, iframe"))try{l.call(this.contentDocument.body)}catch(e){}else if($(this).is("dl"))s(this);else if($(this).is("ol, ul")){var e=$(this).children().get();e.some(a)?s(this):e.some(o)?s(this,!0):e.some(i)&&s(this,!0)}else if($(this).is("tbody")){var t=$(this).children();t.length>3||t.eq(0).children().length>3?t.get().some(i)&&s(this,!0):t.each(l)}else a(this)?s(this):o(this)?s(this,!0):$(this).children(":not("+n+")").each(l)},c=[];return l.call(document.body),c.filter(function(e){return $(e).is(":visible")&&$(e).offset().left>=0})}function t(e,n,t){void 0==n&&(n=0),void 0==t&&(t=e.length);for(var r=0,a=n;a<t;a++)r+=e[a].length;for(var o=r/(t-n),i=0,a=n;a<t;a++)i+=(e[a].length-o)*(e[a].length-o);return{mean:o,stdev:Math.sqrt(i)}}function r(e){var n=$(e).find(":visible").filter(o).hide();$(e).find("ol, ul").addBack("ol, ul").each(a);var t=$(e).data("read-aloud-multi-block")?$(e).children(":visible").get().map(i):i(e).split(h.paraSplitter);return $(e).find(".read-aloud-numbering").remove(),n.show(),t}function a(){var e=$(this).children(),n=e.length?g(e.get(0)):null;n&&!n.match(/^[(]?(\d|[a-zA-Z][).])/)&&e.each(function(e){$("<span>").addClass("read-aloud-numbering").text(e+1+". ").prependTo(this)})}function o(){var e=$(this).css("float"),n=$(this).css("position");return $(this).is(f)||$(this).is("sup")||"right"==e||"fixed"==n}function i(e){return s(e.innerText).trim()}function s(e){return e.replace(/(\w)(\s*?\r?\n)/g,"$1.$2")}function l(e,n){for(var t=[],r=$(e).find("h1, h2, h3, h4, h5, h6, p").filter(":visible").get(0),a=c(r),o=u(e,!0);o&&o!=n;){var i=$(o).is(f);if(!i&&1==o.nodeType&&$(o).is(":visible")){var s=c(o);s<a&&(t.push(o),a=s)}o=u(o,i)}return t.reverse()}function c(e){var n=e&&/^H(\d)$/i.exec(e.tagName);return n?Number(n[1]):100}function u(e,n){return $(e).is("body")?null:1==e.nodeType&&!n&&e.lastChild?e.lastChild:e.previousSibling?e.previousSibling:u(e.parentNode,!0)}function m(e,n){for(var t=e.firstChild;t;){if(n(t))return!0;t=t.nextSibling}return!1}function p(e){return[].concat.apply([],e)}var f="select, textarea, button, label, audio, video, dialog, embed, menu, nav, noframes, noscript, object, script, style, svg, aside, footer, #footer";this.getCurrentIndex=function(){return 0},this.getTexts=function(n){return 0==n?e():null}}function g(e){var n=e.innerText;return n?n.trim():""}function d(e){return e}function m(e){for(var n=[],t="",r=0;r<e.length;r++)e[r]?(t&&(/-$/.test(t)?t=t.substr(0,t.length-1):t+=" "),t+=e[r].replace(/-\r?\n/g,""),e[r].match(/[.!?:)"'\u2019\u201d]$/)&&(n.push(t),t="")):t&&(n.push(t),t="");return t&&n.push(t),n}function p(e,n){return function(e){return new Promise(function(n){setTimeout(n,e)})}(500).then(e).then(function(t){return t&&!t.length&&n-500>0?p(e,n-500):t})}window.connect=e,window.HtmlDoc=u;var h={paraSplitter:/(?:\s*\r?\n\s*){2,}/};h.loadCss=function(e){return $("head").length||$("<head>").prependTo("html"),$("<link>").appendTo("head").attr({type:"text/css",rel:"stylesheet",href:e}),Promise.resolve()},h.loadScript=function(e,n){return new Promise(function(t,r){$.ajax(e,{dataType:"text",success:function(e){eval.call(window,n?n(e):e),t()},error:function(){r(new Error("Failed to load script"))}})})}}(),function(){if(window.chrome&&chrome.ttsEngine){var e=window.remoteTtsEngine=new RemoteTTS(config.serviceUrl);chrome.ttsEngine.onSpeak.addListener(e.speak),chrome.ttsEngine.onStop.addListener(e.stop),chrome.ttsEngine.onPause.addListener(e.pause),chrome.ttsEngine.onResume.addListener(e.resume)}}();var readAloud=new function(){function ready(){return window.jQuery?(window.$?window.$!=window.jQuery&&console.warn("WARNING: Read Aloud embed script may not work because $ != jQuery."):window.$=window.jQuery,Promise.resolve()):ajaxGet("https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js").then(eval)}function speak(e,n){var t=voiceProvider.getLocalVoice(n.lang);return t?(n.voiceName=t.name,n.engine=new LocalTTS(t)):(t=voiceProvider.getRemoteVoice(n.lang),n.voiceName=t?t.voice_name:"default",n.engine=new RemoteTTS(config.serviceUrl)),n.onEnd=function(){speech=null,updateButtons()},speech&&speech.stop(),speech=new Speech(e,n),speech.play()}function updateButtons(){return isPlaying().then(function(e){$(".ra-play").toggle(!e),$(".ra-pause").toggle(e),attribution.toggle(e&&isGoogleTranslate(speech.options.voiceName))})}function isPlaying(){return speech?speech.getState().then(function(e){return"PAUSED"!=e}):Promise.resolve(!1)}function VoiceProvider(){function e(e,n){var t=parseLang(n),r={};return e.forEach(function(e){if(e.lang){var n=parseLang(e.lang);n.lang==t.lang&&(n.rest==t.rest?"female"==e.gender?r.first=r.first||e:r.second=r.second||e:n.rest?"en"==n.lang&&"us"==n.rest?r.fourth=e:r.fourth=r.fourth||e:r.third=r.third||e)}}),r.first||r.second||r.third||r.fourth}window.speechSynthesis&&speechSynthesis.getVoices(),this.getLocalVoice=function(n){return window.speechSynthesis?e(speechSynthesis.getVoices(),n):null},this.getRemoteVoice=function(n){if(window.manifest){var t=manifest.tts_engine.voices;return e(t.filter(function(e){return isAmazonPolly(e.voice_name)}),n)||e(t.filter(function(e){return isMicrosoftCloud(e.voice_name)}),n)||e(t.filter(function(e){return isGoogleTranslate(e.voice_name)}),n)}return null}}function LocalTTS(e){var n;this.speak=function(t,r,a){n=new SpeechSynthesisUtterance,r.lang&&(n.lang=r.lang),r.pitch&&(n.pitch=r.pitch),r.rate&&(n.rate=r.rate),n.text=t,n.voice=e,r.volume&&(n.volume=r.volume),n.onstart=a.bind(null,{type:"start",charIndex:0}),n.onerror=n.onend=a.bind(null,{type:"end",charIndex:t.length}),speechSynthesis.speak(n)},this.isSpeaking=function(e){e(speechSynthesis.speaking)},this.stop=function(){n&&(n.onend=null),speechSynthesis.cancel()},this.prefetch=function(){},this.setNextStartTime=function(){}}function Attribution(){function e(){n=$("<div/>").appendTo(document.body),$("<div>powered&nbsp;by</div>").css({color:"#888","margin-bottom":"3px"}).appendTo(n),$("<span>G</span>").css("color","#4885ed").appendTo(n),$("<span>o</span>").css("color","#db3236").appendTo(n),$("<span>o</span>").css("color","#f4c20d").appendTo(n),$("<span>g</span>").css("color","#4885ed").appendTo(n),$("<span>l</span>").css("color","#3cba54").appendTo(n),$("<span>e</span>").css("color","#db3236").appendTo(n),$("<span>&nbsp;Translate</span>").css("color","#888").appendTo(n),n.css({display:"none",position:"absolute",padding:"6px",color:"black","background-color":"white","border-radius":"3px","box-shadow":"1px 1px 3px gray","font-family":"Arial, Helvetica, sans-serif","font-size":"small","text-align":"center",cursor:"pointer"}).click(function(){window.open("https://translate.google.com/","_blank")})}var n;this.toggle=function(t){if(t){n||e();var r=$(".ra-pause").offset();r&&(r.left=Math.max(0,r.left+$(".ra-pause").outerWidth()/2-n.outerWidth()/2),r.top+=$(".ra-pause").height()+5,n.css(r).show())}else n&&n.hide()}}var pauseBtn=document.querySelector(".ra-pause");pauseBtn&&(pauseBtn.style.display="none"),window.Promise||ajaxGetCb("https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js",eval);var speech,voiceProvider=new VoiceProvider,attribution=new Attribution;this.play=function(e){return ready().then(function(){return speech?speech.play():speak((new HtmlDoc).getTexts(0),e)}).then(updateButtons)},this.speak=function(e,n){return ready().then(speak.bind(this,e,n)).then(updateButtons)},this.pause=function(){return speech?speech.pause().then(updateButtons):Promise.resolve()},this.isPlaying=isPlaying};