<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8"/>
	<title>Try Execute Function</title>
</head>

<body>
	<p>Try Execute Function</p>

	<script>
/**
 * Execute a function
 * If it is failed, try to execute again until some attemps.
 *
 * @param f
 *        A no-argument function
 * @param number
 *        The number of attempt
 * @author lockex1987
 */
function tryExecuteFunction(f, number) {
	// Default try 3 times
	if (number == undefined) {
		number = 3;
	}
	
	var counter = 0;
	do {
		try {
			// Try to execute the function
			f.apply();
			
			// Execute success, set 'counter' equals 'number' to escape the do-while loop
			counter = number;
		} catch (ex) {
			// Increase the counter
			counter++;
			
			// Log the error
			console.log("Try " + counter + "/" + number);
			console.error(ex.message);
			
			// If we already tried 'number' times
			if (counter >= number) {
				// Hide the page load and display the message
				alert("Une erreur est survenue, veuillez r√©essayer.");
			}
		}
	} while (counter < number);
}

function test() {
	var data = undefined;
	var a;

	JSON.parse('{ "a": "xyz}');
	//console.info(data.key);
	
	console.info("Execute function test");
}

tryExecuteFunction(test);
	</script>
</body>
</html>